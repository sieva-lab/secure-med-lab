<form novalidate class="patient-form" (submit.preventDefault)="onSubmit()">
	<div class="form-card">
		<h2 class="form-title">Create Patient</h2>

		@for (error of patientForm().errors(); track $index) {
			<securemed-alert type="error">{{ error.message }}</securemed-alert>
		}

		@if (patientForm().touched() && patientForm().errorSummary().length > 0) {
			<div class="validation-summary mb-6">
				<h3 class="validation-title">Please fix the following errors:</h3>
				<ul class="validation-list">
					@for (error of patientForm().errorSummary(); track $index) {
						<li class="validation-item">{{ error | validationMessage: true }}</li>
					}
				</ul>
			</div>
		}

		<fieldset class="form-fieldset mb-6">
			<legend>Patient Information</legend>
			<div class="form-row">
				<div class="form-group">
					<label [for]="patientForm.firstName().name()">First Name</label>
					<input type="text" [id]="patientForm.firstName().name()" [field]="patientForm.firstName" />
				</div>

				<div class="form-group">
					<label [for]="patientForm.lastName().name()">Last Name</label>
					<input type="text" [id]="patientForm.lastName().name()" [field]="patientForm.lastName" />
				</div>
			</div>
		</fieldset>

		<div class="checkbox-group">
			<input type="checkbox" id="hasBillingAddress" [field]="patientForm.hasBillingAddress" />
			<label for="hasBillingAddress" class="checkbox-label">Add Billing Address</label>
		</div>

		@if (!patientForm.billingAddress().hidden()) {
			<fieldset class="form-fieldset address-fieldset">
				<legend>Billing Address</legend>
				<securemed-patient-address [address]="patientForm.billingAddress" />
			</fieldset>
		}

		<div class="checkbox-group">
			<input type="checkbox" id="hasShippingAddress" [field]="patientForm.hasShippingAddress" />
			<label for="hasShippingAddress" class="checkbox-label">Add Shipping Address</label>
		</div>

		@if (!patientForm.shippingAddress().hidden()) {
			<fieldset class="form-fieldset address-fieldset mb-6">
				<legend>Shipping Address</legend>
				<securemed-patient-address [address]="patientForm.shippingAddress">
					<div class="form-group">
						<label for="note">Note</label>
						<textarea id="note" [field]="patientForm.shippingAddress.note"></textarea>
					</div>
				</securemed-patient-address>
			</fieldset>
		}

		<div class="form-actions">
			<button type="submit" class="button" [disabled]="patientForm().submitting()">
				@if (patientForm().submitting()) {
					<div class="loading"></div>
					<span>Creating Patient...</span>
				} @else {
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="18"
						height="18"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
						<circle cx="9" cy="7" r="4" />
						<line x1="19" y1="8" x2="19" y2="14" />
						<line x1="22" y1="11" x2="16" y2="11" />
					</svg>
					<span>Create Patient</span>
				}
			</button>
		</div>
	</div>
</form>
